# Argo Rollouts: Promote, PromoteFull, Abort, Retry, and Restart

## 🎯 Overview

Argo Rollouts provides advanced deployment strategies (like Canary, BlueGreen, and Progressive Delivery) that allow you to **promote**, **abort**, **retry**, or **restart** rollouts safely during an update.

This guide summarizes how to control rollout lifecycles using both **CLI** and **Web UI**.

---

## 🟢 Promote Actions

### 1. Promote (Step-by-Step)
Used when you want to manually advance a rollout to the next canary step without waiting for pauses or analysis.

#### 🧩 CLI Example
Check the current status.
```
kubectl argo rollouts get rollout rollouts-demo
```
Expected Output:
```
Name:            rollouts-demo
Namespace:       default
Status:          ✔ Healthy
Strategy:        Canary
  Step:          12/12
  SetWeight:     100
  ActualWeight:  100
Images:          argoproj/rollouts-demo:blue (stable)
Replicas:
  Desired:       5
  Current:       5
  Updated:       5
  Ready:         5
  Available:     5

NAME                                       KIND        STATUS     AGE  INFO
⟳ rollouts-demo                            Rollout     ✔ Healthy  4s
└──# revision:1
   └──⧉ rollouts-demo-687d76d795           ReplicaSet  ✔ Healthy  4s   stable
      ├──□ rollouts-demo-687d76d795-2dsmc  Pod         ✔ Running  4s   ready:1/1
      ├──□ rollouts-demo-687d76d795-2mpr6  Pod         ✔ Running  4s   ready:1/1
      ├──□ rollouts-demo-687d76d795-7tdwl  Pod         ✔ Running  4s   ready:1/1
      ├──□ rollouts-demo-687d76d795-dxjjh  Pod         ✔ Running  4s   ready:1/1
      └──□ rollouts-demo-687d76d795-p6dbb  Pod         ✔ Running  4s   ready:1/1
```
Update the image.
```
kubectl argo rollouts set image rollouts-demo rollouts-demo=argoproj/rollouts-demo:green
kubectl argo rollouts get rollout rollouts-demo
```
Expected Output: 
```
Name:            rollouts-demo
Namespace:       default
Status:          ॥ Paused
Message:         CanaryPauseStep
Strategy:        Canary
  Step:          1/12
  SetWeight:     10
  ActualWeight:  16
Images:          argoproj/rollouts-demo:blue (stable)
                 argoproj/rollouts-demo:green (canary)
Replicas:
  Desired:       5
  Current:       6
  Updated:       1
  Ready:         6
  Available:     6

NAME                                       KIND        STATUS     AGE  INFO
⟳ rollouts-demo                            Rollout     ॥ Paused   66s
├──# revision:2
│  └──⧉ rollouts-demo-7d9c645dbb           ReplicaSet  ✔ Healthy  27s  canary
│     └──□ rollouts-demo-7d9c645dbb-qpz56  Pod         ✔ Running  27s  ready:1/1
└──# revision:1
   └──⧉ rollouts-demo-687d76d795           ReplicaSet  ✔ Healthy  66s  stable
      ├──□ rollouts-demo-687d76d795-2dsmc  Pod         ✔ Running  66s  ready:1/1
      ├──□ rollouts-demo-687d76d795-2mpr6  Pod         ✔ Running  66s  ready:1/1
      ├──□ rollouts-demo-687d76d795-7tdwl  Pod         ✔ Running  66s  ready:1/1
      ├──□ rollouts-demo-687d76d795-dxjjh  Pod         ✔ Running  66s  ready:1/1
      └──□ rollouts-demo-687d76d795-p6dbb  Pod         ✔ Running  66s  ready:1/1
```
Promote for new step.
```
kubectl argo rollouts promote rollouts-demo
kubectl argo rollouts get rollout rollouts-demo --watch
```
Expected Output:
```
Name:            rollouts-demo
Namespace:       default
Status:          ॥ Paused
Message:         CanaryPauseStep
Strategy:        Canary
  Step:          3/12
  SetWeight:     20
  ActualWeight:  20
Images:          argoproj/rollouts-demo:blue (stable)
                 argoproj/rollouts-demo:green (canary)
Replicas:
  Desired:       5
  Current:       5
  Updated:       1
  Ready:         5
  Available:     5

NAME                                       KIND        STATUS         AGE  INFO
⟳ rollouts-demo                            Rollout     ॥ Paused       63s
├──# revision:2
│  └──⧉ rollouts-demo-7d9c645dbb           ReplicaSet  ✔ Healthy      42s  canary
│     └──□ rollouts-demo-7d9c645dbb-sh4xm  Pod         ✔ Running      42s  ready:1/1
└──# revision:1
   └──⧉ rollouts-demo-687d76d795           ReplicaSet  ✔ Healthy      63s  stable
      ├──□ rollouts-demo-687d76d795-4kstz  Pod         ◌ Terminating  63s  ready:1/1
      ├──□ rollouts-demo-687d76d795-72zcc  Pod         ✔ Running      63s  ready:1/1
      ├──□ rollouts-demo-687d76d795-c8fsv  Pod         ✔ Running      63s  ready:1/1
      ├──□ rollouts-demo-687d76d795-jdksl  Pod         ✔ Running      63s  ready:1/1
      └──□ rollouts-demo-687d76d795-jt468  Pod         ✔ Running      63s  ready:1/1
```


**Expected Output:**
- The rollout advances one canary step forward.
- `kubectl argo rollouts get rollout rollouts-demo --watch` shows progressing status.

#### 🌐 UI
- Go to [Argo Rollouts UI](http://argorollouts.apsis.localnet).
- Select your rollout (`rollouts-demo`).
- Click **Promote** ➜ rollout advances to the next step.

---

### 2. PromoteFull (Fast Forward All Steps)
Used to **bypass all remaining canary steps** and promote the new version directly to stable.

#### 🧩 CLI Example
```bash
kubectl argo rollouts promote-full rollouts-demo
```
or
```bash
kubectl argo rollouts promote --full rollouts-demo
```

**Expected Output:**
- Rollout immediately shifts to 100% traffic for the new image (e.g., `green`).
- ReplicaSet becomes stable and the canary phase ends.

#### 🌐 UI
- Go to [Argo Rollouts UI](http://argorollouts.apsis.localnet).
- Click **Promote Full** (✅).
- Verify live updates at [http://demorollouts.apsis.localnet](http://demorollouts.apsis.localnet).

---

## 🔴 Control Actions (Abort, Retry, Restart)

These actions help recover or roll back a rollout when issues occur.

### 1. Abort
Immediately stops a progressing rollout and reverts traffic back to the stable version.

#### 🧩 CLI
```bash
kubectl argo rollouts abort rollouts-demo
```

#### 🌐 UI
- Click **Abort (🛑)** ➜ Traffic returns to stable pods.

---

### 2. Retry
Used after an aborted rollout to retry the failed update.

#### 🧩 CLI
```bash
kubectl argo rollouts retry rollouts-demo
```

#### 🌐 UI
- Click **Retry (🔁)** ➜ Rollout restarts from the failed canary step.

---

### 3. Restart
Restarts the rollout (useful after configuration or environment updates).

#### 🧩 CLI
```bash
kubectl argo rollouts restart rollouts-demo
```

#### 🌐 UI
- Click **Restart (♻️)** ➜ All pods are re-deployed without changing image version.

---

## ✅ Verification Steps

1. Monitor rollout with:
   ```bash
   kubectl argo rollouts get rollout rollouts-demo --watch
   ```
2. Access rollout UI:
   - Argo UI: [http://argorollouts.apsis.localnet](http://argorollouts.apsis.localnet)
   - App: [http://demorollouts.apsis.localnet](http://demorollouts.apsis.localnet)

3. Observe color transitions:
   - `blue` → `green` (after Promote or PromoteFull)
   - Stable status reflects in both CLI and UI.

---

## 🧠 Summary Table

| Action | CLI Command | Description | UI Equivalent |
|--------|--------------|--------------|----------------|
| 🟢 Promote | `kubectl argo rollouts promote` | Move one step forward | Promote |
| 🟢 PromoteFull | `kubectl argo rollouts promote-full` | Skip to 100% traffic | Promote Full |
| 🔴 Abort | `kubectl argo rollouts abort` | Stop rollout and revert | Abort |
| 🔴 Retry | `kubectl argo rollouts retry` | Retry aborted rollout | Retry |
| 🔴 Restart | `kubectl argo rollouts restart` | Restart rollout pods | Restart |

---
Next:  
Prev: [Progressive Canary Deployment](https://github.com/jamaldevsecops/ArgoCD/blob/master/argo-rollouts/docs/3.Progressive-Canary-Deployment.md)   

*Author: Jamal Hossain*  
*Date: 2025-10-10*  
